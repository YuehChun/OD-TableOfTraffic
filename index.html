<html>
<head>
<meta charset="utf-8">
<title>Taipei OD Table - Demo </title>
<script>document.write('<script src="http://' + (location.host || 'localhost').split(':')[0] + ':35729/livereload.js?snipver=1"></' + 'script>')</script>
<link rel="stylesheet" href="css/leaflet.css" />
<link rel="stylesheet" href="css/bootstrap.min.css" >
<link rel="stylesheet" href="https://unpkg.com/leaflet@1.2.0/dist/leaflet.css"
   integrity="sha512-M2wvCLH6DSRazYeZRIm1JnYyh22purTM+FDB5CsyxtQJYeKq83arPe5wgbNmcFXGqiSH2XR8dT/fJISVA1r/zQ=="
   crossorigin=""/>

 <script src="https://unpkg.com/leaflet@1.2.0/dist/leaflet.js"
   integrity="sha512-lInM/apFSqyy1o6s89K4iQUKg6ppXEgsVxT35HbzUupEVRh2Eu9Wdl4tHj7dZO0s1uvplcYGmt3498TtHq+log=="
   crossorigin=""></script>
<script src="js/leaflet.curve.js"></script>
<script src="js/jquery-3.2.1.slim.min.js"></script>
<script src="js/popper.min.js"></script>
<script src="js/bootstrap.min.js"></script>
<script src="js/d3.v3.min.js"></script>
<script src="js/Leaflet.Dialog.js"></script>
<!-- <script src="https://d3js.org/d3-selection.v1.min.js"></script> -->

<!-- Load c3.css -->
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.5.0/css/font-awesome.min.css">
<link href="css/c3.min.css" rel="stylesheet">
<link href="css/main.css" rel="stylesheet">
<link href="css/Leaflet.Dialog.css" rel="stylesheet">

<!-- Load d3.js and c3.js -->
<script src="js/c3.min.js"></script>

<script src="js/preProcess.js"></script>
</head>
<body>
<div class="container-fluid">
  <div class="row">
	<div class="col-xs-12 col-md-12 col-lg-12" id="map"></div>
  </div>
  <div class="row">
  	<div class="col-xs-12 col-md-12 col-lg-12 vcenter" id="d3">
		<div id="chart" class="barChartClass" >請選擇一個行政區</div>
	</div>
  </div>
</div>



<script>


var map = L.map('map').setView([25.03241, 121.523208], 11);
var mapZoomLevel = map.getZoom();
L.tileLayer('http://{s}.basemaps.cartocdn.com/light_nolabels/{z}/{x}/{y}.png', {attribution: '&copy; <a href="http://osm.org/copyright">OpenStreetMap</a> contributors',apikey:'c4377a218be242ddb3297260d216b11b'}).addTo(map);

// read csv data 

var newLineArray = [],
  	newMarkerArray = [],
  	barChartData = [],
  	chartSeries = [],
  	ODTableData = [],
  	tempArrayData = [],
	nodeNameXY = [],
  	nodeNameArray = [],
  	temp_ODTable = [],
  	tempTotal_Node= [];

var colorBlackSet = ['#D3D3D3','#C0C0C0','#A9A9A9','#778899','#708090','#808080','#696969','#000000'];
var colorGreenSet = ['#ADFF2F','#7CFC00','#7FFF00','#00FF00','#32CD32','#9ACD32','#8FBC8F','#3CB371','#66CDAA','#20B2AA','#008080','#2E8B57','#228B22','#006400','#808000','#556B2F','#2F4F4F'];
var colorHeatMapSet = ['#F1F8E9','#DCEDC8','#C5E1A5','#AED581','#FFF59D','#FFF176','#FFEE58','#FF8A65','#FF7043','#FF5722'];
var colorHeatMapSet2 = ['#AED581','#9CCC65','#8BC33A','#7CB342','#FFEB3B','#FDD835','#FBC02D','#FF8A65','#FF7043','#FF5722'];
var colorBrown = ['#AAAAAA','#AAAAAA','#AAAAAA','#AAAAAA','#AAAAAA','#AAAAAA','#AAAAAA'];

d3.csv("./data.csv", function(data) {
	tempArrayData=data;
	var LBD = LoadCSVData(tempArrayData,colorHeatMapSet2);
    barChartData=processOD(LBD.temp_OD);
    barChartData[""]={};
    newMarkerArray = processMarker(LBD.nodeNameArray,LBD.nodeNameXY,LBD.enter_Number,LBD.exit_Number);
    initLine(LBD.newLineArray , map);
    initMarker(newMarkerArray , map);
    initGaugeChart(map);
});


    var contents = [
                    "<div id='rateChart' class='rateChart'>Hello! Welcome to your nice new dialog box!</div>",
                    "<button class='btn btn-primary' onclick='callChange()'>AAAAAAA</button><br/><br/>",
                    "<button class='btn btn-primary' onclick='dialog.setSize([ 350, 350 ])'>dialog.setSize([ 350, 350 ])</button><br/><br/>",
                    "<button class='btn btn-primary' onclick='dialog.setLocation([ 50, 50 ])'>dialog.setLocation([ 50, 50 ])</button><br/><br/>",
                    "<button class='btn btn-danger' onclick='dialog.freeze()'>dialog.freeze()</button>&nbsp;&nbsp;",
                    "<button class='btn btn-success' onclick='dialog.unfreeze()'>dialog.unfreeze()</button><br/><br/>",
                    "<button class='btn btn-danger' onclick='dialog.hideClose()'>dialog.hideClose()</button>",
                    "<button class='btn btn-success' onclick='dialog.showClose()'>dialog.showClose()</button><br/><br/>",
                    "<button class='btn btn-danger' onclick='dialog.hideResize()'>dialog.hideResize()</button>",
                    "<button class='btn btn-success' onclick='dialog.showResize()'>dialog.showResize()</button><br/><br/>"
                    ].join('');





    // map.on('dialog:opened', function(e){ console.log("dialog opened event fired."); });
    // map.on('dialog:closed', function(e){ console.log("dialog closed event fired."); });
    // map.on('dialog:destroyed', function(e){ console.log("dialog destroyed event fired."); });
    // map.on('dialog:locked', function(e){ console.log("dialog locked event fired."); });
    // map.on('dialog:unlocked', function(e){ console.log("dialog unlocked event fired."); });
    // map.on('dialog:frozen', function(e){ console.log("dialog frozen event fired."); });
    // map.on('dialog:unfrozen', function(e){ console.log("dialog unfrozen event fired."); });
    // map.on('dialog:updated', function(e){ console.log("dialog updated event fired."); });
    // map.on('dialog:resizestart', function(e){ console.log("dialog resizestart event fired."); });
    // map.on('dialog:resizing', function(e){ console.log("dialog resizing event fired."); });
    // map.on('dialog:resizeend', function(e){ console.log("dialog resizeend event fired."); });
    // map.on('dialog:movestart', function(e){ console.log("dialog movestart event fired."); });
    // map.on('dialog:moving', function(e){ console.log("dialog moving event fired."); });
    // map.on('dialog:moveend', function(e){ console.log("dialog moveend event fired."); });
    // map.on('dialog:closehidden', function(e){ console.log("dialog closehidden event fired."); });
    // map.on('dialog:closeshown', function(e){ console.log("dialog closeshown event fired."); });
    // map.on('dialog:resizehidden', function(e){ console.log("dialog resizehidden event fired."); });
    // map.on('dialog:resizeshown', function(e){ console.log("dialog resizeshown event fired."); });


function onMapClick(e) {
    console.log(e.latlng);
}

function changeMarkerByZoom(zoomLevel){

}
// map.on('click', onMapClick);
// map.on('zoomend', function(){
// 	preZoomLevel = mapZoomLevel
// 	mapZoomLevel = map.getZoom();
// 	// console.log('change zoom level : '+mapZoomLevel);
// 	for (var i = 0 ; i< circleMarkerSet.length ; i++){
// 		_val = circleMarkerSet[i].getRadius()/preZoomLevel;
// 		circleMarkerSet[i].setRadius(_val * mapZoomLevel);
// 		// console.log(_val)
// 	}
// });
</script>

</body>
</html>
